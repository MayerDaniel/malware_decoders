'''
Written by Jason Reaves - @sysopfb
Free to use, attribute properly.
'''
from ctypes import *
import binascii
import sys


rlcrypt = cdll.LoadLibrary('./rlcrypt.so')

def ammy_decrypt(key, data):
	buf = create_string_buffer(data)
	cb = c_int(len(buf))
	keybuf = create_string_buffer(key)
	retval = rlcrypt.decode(byref(buf), cb, keybuf)
	return buf.raw

if __name__ == "__main__":
	data = open(sys.argv[1], 'rb').read()
	key = binascii.unhexlify('6b2f3da798926116a63f187b9891e0d4bc5a6382')
	t = ammy_decrypt(key,data)


